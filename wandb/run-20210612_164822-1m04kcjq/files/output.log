done generating data trainsize: 334 testsize 745
{'lab_name': 'label', 'fname': 'cache/one_dat_cache_full_label.npy', 'num_input': 32, 'timesteps': 66, 'num_hidden': 128, 'num_layers': 2, 'num_classes': 1, 'dropout_keep_prob': 0.9, 'use_uncertainty': False, 'use_attention': True, 'simple': False, 'num_tasks': -1, 'batch_size': 64, 'model_dir': './out', 'model_dir_pretrain': None, 'lr_base': 0.001, 'training_steps': 55000, 'reduce_lr_step': 50000, 'train_file': 'evidence.txt_proc_2_train.pkl', 'test_file': 'evidence.txt_proc_2_test.pkl', 'reduce_train': 0.5, 'scaling_dict': {'0': (6.7287, 163.77)}}
WARNING:tensorflow:From /home/ash022/anaconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/data/ops/dataset_ops.py:1419: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From bidirectional_lstm.py:35: BasicLSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/ash022/anaconda3/envs/py37/lib/python3.7/site-packages/tensorflow/contrib/rnn/python/ops/rnn.py:233: bidirectional_dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.Bidirectional(keras.layers.RNN(cell))`, which is equivalent to this API
WARNING:tensorflow:From /home/ash022/anaconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/ops/rnn.py:443: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
Tensor("concat:0", shape=(?, 256), dtype=float32) Tensor("stack_bidirectional_rnn/cell_1/bidirectional_rnn/bw/bw/while/Exit_4:0", shape=(?, 128), dtype=float32) Tensor("stack_bidirectional_rnn/cell_1/bidirectional_rnn/fw/fw/while/Exit_4:0", shape=(?, 128), dtype=float32)
WARNING:tensorflow:From /home/ash022/anaconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/ops/losses/losses_impl.py:667: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2021-06-12 16:48:31.504778: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2021-06-12 16:48:31.511687: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3392145000 Hz
2021-06-12 16:48:31.513980: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55e346d0d440 executing computations on platform Host. Devices:
2021-06-12 16:48:31.514028: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2021-06-12 16:48:31.659972: E tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:984] could not open file to read NUMA node: /sys/bus/pci/devices/0000:81:00.0/numa_node
Your kernel may have been built without NUMA support.
2021-06-12 16:48:31.660284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties:
name: NVIDIA GeForce RTX 2070 SUPER major: 7 minor: 5 memoryClockRate(GHz): 1.77
pciBusID: 0000:81:00.0
totalMemory: 8.00GiB freeMemory: 6.99GiB
2021-06-12 16:48:31.660335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2021-06-12 16:48:31.660755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-12 16:48:31.660791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0
2021-06-12 16:48:31.660801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N
2021-06-12 16:48:31.661087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1194] Could not identify NUMA node of platform GPU id 0, defaulting to 0.  Your kernel may not have been built with NUMA support.
2021-06-12 16:48:31.661202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6796 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 2070 SUPER, pci bus id: 0000:81:00.0, compute capability: 7.5)
2021-06-12 16:48:31.663484: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55e3476c4c40 executing computations on platform CUDA. Devices:
2021-06-12 16:48:31.663526: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): NVIDIA GeForce RTX 2070 SUPER, Compute Capability 7.5
2021-06-12 16:48:39.457190: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library libcublas.so.10.0 locally
Step 0, Minibatch Loss= 0.2556 time elapsed: 7.5074s
